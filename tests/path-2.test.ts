import { OpType } from "../src/basic";
import { Path } from "../src/path";
import { PathBuilder } from "../src/pathbuilder";

describe(`path 2`, () => {
    test('coin union', () => {

        const builder = new PathBuilder();
        builder.moveTo(50, 100)
        builder.cubicTo(100, 50, 77.58923888895069, 100, 100, 77.58923888895069)
        builder.cubicTo(50, 0, 100, 22.4107611110493, 77.58923888895069, 0)
        builder.cubicTo(0, 50, 22.4107611110493, 0, 0, 22.4107611110493)
        builder.cubicTo(50, 100, 0, 77.58923888895069, 22.4107611110493, 100)
        builder.close()

        const path = builder.getPath();

        builder.moveTo(50, 100)
        builder.cubicTo(100, 50, 77.58923888895069, 100, 100, 77.58923888895069)
        builder.cubicTo(50, 0, 100, 22.4107611110493, 77.58923888895069, 0)
        builder.cubicTo(0, 50, 22.4107611110493, 0, 0, 22.4107611110493)
        builder.cubicTo(50, 100, 0, 77.58923888895069, 22.4107611110493, 100)
        builder.close()

        const path1 = builder.getPath();

        path.op(path1, OpType.Union)
        expect(path.toSVGString()).toBe(path1.toSVGString())
    })

    test('multi union', () => {
        const builder = new PathBuilder();
        builder.moveTo(50, 100)
        builder.cubicTo(100, 50, 77.58923888895069, 100, 100, 77.58923888895069)
        builder.cubicTo(50, 0, 100, 22.4107611110493, 77.58923888895069, 0)
        builder.cubicTo(0, 50, 22.4107611110493, 0, 0, 22.4107611110493)
        builder.cubicTo(50, 100, 0, 77.58923888895069, 22.4107611110493, 100)
        builder.close()
        const path0 = builder.getPath();

        const path1 = path0.clone();
        const path2 = path0.clone();

        path1.translate(-30, 30)
        path2.translate(30, 30)

        path0.op(path1, OpType.Union)
        path0.op(path2, OpType.Union)

        expect(path0.toSVGString()).toBe('M97.02157755835391 32.97842251628198C90.04994966666044 13.754759851204161 71.61413813476562 0 50 0' +
            'C28.385861916623327 0 9.950050421004146 13.754759785798562 2.9784224913725366 32.97842237916561C-16.24524014879584 39.95005033333956 -30 58.38586186523436 -30 80' +
            'C-30 107.58923888895069 -7.5892388889507 130 20 130C31.250681130474213 130 41.64020927940106 126.27321105211986 49.99999996269968 119.98821764044047' +
            'C58.359790618869816 126.27321101562899 68.74931881444523 130 80 130C107.58923888895069 130 130 107.58923888895069 130 80' +
            'C130 58.38586191662333 116.24524021420143 39.95005042100414 97.02157762083439 32.978422491372534Z')
    })

    test('point', () => {
        const path0 = new Path('M0.155099025676379 3.8812735568349095L0.155099025676379 3.8812735568349095C-0.03728889027369808 4.054500414430392 -0.052821997130917064 4.350889749558076 0.12040486046456522 4.543277665508153L2.3286183487905014 6.995747201057565C2.5018452063859837 7.188135117007643 2.7982345415136676 7.203668223864861 2.9906224574637443 7.030441366269379L2.9906224574637443 7.030441366269379C3.183010373413822 6.857214508673897 3.1985434802710406 6.560825173546213 3.0253166226755583 6.368437257596136L0.8171031343496223 3.9159677220467235C0.64387627675414 3.7235798060966463 0.3474869416264561 3.708046699239427 0.155099025676379 3.8812735568349095Z')
        path0.bbox();
    })
})